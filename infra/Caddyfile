# API público con HTTPS automático
api.hypeatlas.app {
    encode zstd gzip

    # CORS simple; tu API también valida CORS por ENV si quieres
    @cors {
        header Origin *
    }
    header {
        Access-Control-Allow-Origin "{http.request.header.Origin}"
        Access-Control-Allow-Methods "GET, POST, OPTIONS"
        Access-Control-Allow-Headers "Authorization, Content-Type, X-API-Key"
        Access-Control-Allow-Credentials "true"
        defer
    }
    handle_options {
        respond "" 204
    }

    # La API corre detrás en el mismo docker network
    reverse_proxy api:8080
}
